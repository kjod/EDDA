barplot(rpois(60, lambda = 1), main="Lambda: 1", xlab="N = 60")
barplot(rpois(60, lambda = 4), main="Lambda: 4", xlab="N = 60")
barplot(rpois(60, lambda = 8), main="Lambda: 8", xlab="N = 60")
dt_ls(x, df, mu, sigma) #=	1/sigma * dt((x - mu)/sigma, df)
library(mgcv)
Fi.gev <- function(z,mu,sigma,xi) {
## GEV inverse cdf.
xi[abs(xi)<1e-8] <- 1e-8 ## approximate xi=0, by small xi
x <- mu + ((-log(z))^-xi-1)*sigma/xi
}
## simulate test data...
f0 <- function(x) 2 * sin(pi * x)
f1 <- function(x) exp(2 * x)
f2 <- function(x) 0.2 * x^11 * (10 * (1 - x))^6 + 10 *
(10 * x)^3 * (1 - x)^10
set.seed(1)
n <- 500
x0 <- runif(n);x1 <- runif(n);x2 <- runif(n)
mu <- f2(x2)
rho <- f0(x0)
xi <- (f1(x1)-4)/9
y <- Fi.gev(runif(n),mu,exp(rho),xi)
dat <- data.frame(y,x0,x1,x2);pairs(dat)
## fit model....
b <- gam(list(y~s(x2),~s(x0),~s(x1)),family=gevlss,data=dat)
## plot and look at residuals...
plot(b,pages=1,scale=0)
summary(b)
par(mfrow=c(2,2))
mu <- fitted(b)[,1];rho <- fitted(b)[,2]
xi <- fitted(b)[,3]
## Get the predicted expected response...
fv <- mu + exp(rho)*(gamma(1-xi)-1)/xi
rsd <- residuals(b)
plot(fv,rsd);qqnorm(rsd)
plot(fv,residuals(b,"pearson"))
plot(fv,residuals(b,"response"))
africa_data=read.table("africa.txt", header=TRUE)
plot(rpois(20, lambda = 1, 1:100)
#use line chart here
#par(mfrow=c(3,3))
#barplot(rpois(20, lambda = 1), main="Lambda: 1", xlab="N = 20")
#barplot(rpois(20, lambda = 4), main="Lambda: 4", xlab="N = 20")
#barplot(rpois(20, lambda = 8), main="Lambda: 8", xlab="N = 20")
#barplot(rpois(40, lambda = 1), main="Lambda: 1", xlab="N = 40")
#barplot(rpois(40, lambda = 4), main="Lambda: 4", xlab="N = 40")
#barplot(rpois(40, lambda = 8), main="Lambda: 8", xlab="N = 40")
#barplot(rpois(60, lambda = 1), main="Lambda: 1", xlab="N = 60")
#barplot(rpois(60, lambda = 4), main="Lambda: 4", xlab="N = 60")
#barplot(rpois(60, lambda = 8), main="Lambda: 8", xlab="N = 60")
africa_data=read.table("africa.txt", header=TRUE)
plot(rpois(20, lambda = 1, 1:100))
africa_data=read.table("africa.txt", header=TRUE)
plot(rpois(20, lambda = 1))
#use line chart here
#par(mfrow=c(3,3))
#barplot(rpois(20, lambda = 1), main="Lambda: 1", xlab="N = 20")
#barplot(rpois(20, lambda = 4), main="Lambda: 4", xlab="N = 20")
#barplot(rpois(20, lambda = 8), main="Lambda: 8", xlab="N = 20")
#barplot(rpois(40, lambda = 1), main="Lambda: 1", xlab="N = 40")
#barplot(rpois(40, lambda = 4), main="Lambda: 4", xlab="N = 40")
#barplot(rpois(40, lambda = 8), main="Lambda: 8", xlab="N = 40")
#barplot(rpois(60, lambda = 1), main="Lambda: 1", xlab="N = 60")
#barplot(rpois(60, lambda = 4), main="Lambda: 4", xlab="N = 60")
#barplot(rpois(60, lambda = 8), main="Lambda: 8", xlab="N = 60")
africa_data=read.table("africa.txt", header=TRUE)
hist(rpois(20, lambda = 1))
#use line chart here
#par(mfrow=c(3,3))
#barplot(rpois(20, lambda = 1), main="Lambda: 1", xlab="N = 20")
#barplot(rpois(20, lambda = 4), main="Lambda: 4", xlab="N = 20")
#barplot(rpois(20, lambda = 8), main="Lambda: 8", xlab="N = 20")
#barplot(rpois(40, lambda = 1), main="Lambda: 1", xlab="N = 40")
#barplot(rpois(40, lambda = 4), main="Lambda: 4", xlab="N = 40")
#barplot(rpois(40, lambda = 8), main="Lambda: 8", xlab="N = 40")
#barplot(rpois(60, lambda = 1), main="Lambda: 1", xlab="N = 60")
#barplot(rpois(60, lambda = 4), main="Lambda: 4", xlab="N = 60")
#barplot(rpois(60, lambda = 8), main="Lambda: 8", xlab="N = 60")
africa_data=read.table("africa.txt", header=TRUE)
hist(rpois(100, lambda = 1))
#use line chart here
#par(mfrow=c(3,3))
#barplot(rpois(20, lambda = 1), main="Lambda: 1", xlab="N = 20")
#barplot(rpois(20, lambda = 4), main="Lambda: 4", xlab="N = 20")
#barplot(rpois(20, lambda = 8), main="Lambda: 8", xlab="N = 20")
#barplot(rpois(40, lambda = 1), main="Lambda: 1", xlab="N = 40")
#barplot(rpois(40, lambda = 4), main="Lambda: 4", xlab="N = 40")
#barplot(rpois(40, lambda = 8), main="Lambda: 8", xlab="N = 40")
#barplot(rpois(60, lambda = 1), main="Lambda: 1", xlab="N = 60")
#barplot(rpois(60, lambda = 4), main="Lambda: 4", xlab="N = 60")
#barplot(rpois(60, lambda = 8), main="Lambda: 8", xlab="N = 60")
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(2,2))
hist(rpois(100, lambda = 1))
hist(rpois(100, lambda = 5))
hist(rpois(100, lambda = 10))
hist(rpois(100, lambda = 15))
#use line chart here
#par(mfrow=c(3,3))
#barplot(rpois(20, lambda = 1), main="Lambda: 1", xlab="N = 20")
#barplot(rpois(20, lambda = 4), main="Lambda: 4", xlab="N = 20")
#barplot(rpois(20, lambda = 8), main="Lambda: 8", xlab="N = 20")
#barplot(rpois(40, lambda = 1), main="Lambda: 1", xlab="N = 40")
#barplot(rpois(40, lambda = 4), main="Lambda: 4", xlab="N = 40")
#barplot(rpois(40, lambda = 8), main="Lambda: 8", xlab="N = 40")
#barplot(rpois(60, lambda = 1), main="Lambda: 1", xlab="N = 60")
#barplot(rpois(60, lambda = 4), main="Lambda: 4", xlab="N = 60")
#barplot(rpois(60, lambda = 8), main="Lambda: 8", xlab="N = 60")
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(2,3))
hist(rpois(100, lambda = 1))
hist(rpois(100, lambda = 5))
hist(rpois(100, lambda = 10))
hist(rpois(100, lambda = 15))
hist(rpois(100, lambda = 20))
hist(rpois(100, lambda = 25))
#use line chart here
#par(mfrow=c(3,3))
#barplot(rpois(20, lambda = 1), main="Lambda: 1", xlab="N = 20")
#barplot(rpois(20, lambda = 4), main="Lambda: 4", xlab="N = 20")
#barplot(rpois(20, lambda = 8), main="Lambda: 8", xlab="N = 20")
#barplot(rpois(40, lambda = 1), main="Lambda: 1", xlab="N = 40")
#barplot(rpois(40, lambda = 4), main="Lambda: 4", xlab="N = 40")
#barplot(rpois(40, lambda = 8), main="Lambda: 8", xlab="N = 40")
#barplot(rpois(60, lambda = 1), main="Lambda: 1", xlab="N = 60")
#barplot(rpois(60, lambda = 4), main="Lambda: 4", xlab="N = 60")
#barplot(rpois(60, lambda = 8), main="Lambda: 8", xlab="N = 60")
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(3,2))
hist(rpois(100, lambda = 1))
hist(rpois(100, lambda = 5))
hist(rpois(100, lambda = 10))
hist(rpois(100, lambda = 15))
hist(rpois(100, lambda = 20))
hist(rpois(100, lambda = 25))
#use line chart here
#par(mfrow=c(3,3))
#barplot(rpois(20, lambda = 1), main="Lambda: 1", xlab="N = 20")
#barplot(rpois(20, lambda = 4), main="Lambda: 4", xlab="N = 20")
#barplot(rpois(20, lambda = 8), main="Lambda: 8", xlab="N = 20")
#barplot(rpois(40, lambda = 1), main="Lambda: 1", xlab="N = 40")
#barplot(rpois(40, lambda = 4), main="Lambda: 4", xlab="N = 40")
#barplot(rpois(40, lambda = 8), main="Lambda: 8", xlab="N = 40")
#barplot(rpois(60, lambda = 1), main="Lambda: 1", xlab="N = 60")
#barplot(rpois(60, lambda = 4), main="Lambda: 4", xlab="N = 60")
#barplot(rpois(60, lambda = 8), main="Lambda: 8", xlab="N = 60")
africa_data
#Analysisof variance
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size+numelec +numregim,family=poisson,data=africa_data)
summary(galaglm)
#Analysisof variance
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size +numregim,family=poisson,data=africa_data)
summary(galaglm)
#Analysisof variance
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size +numregim,family=poisson,data=africa_data)
summary(galaglm)
#Analysisof variance
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties,family=poisson,data=africa_data)
summary(galaglm)
plot(residuals(galaglm),parties)
attach(africa_data)
plot(residuals(galaglm),parties)
par(mfrow=c(2,2))
attach(africa_data)
plot(residuals(galaglm),parties)
plot(residuals(galaglm),pollib)
plot(residuals(galaglm),oligarchy)
par(mfrow=c(2,2))
attach(africa_data)
plot(residuals(galaglm),parties)
plot(residuals(galaglm),pollib)
#plot(residuals(galaglm),oligarchy)
par(mfrow=c(2,2))
attach(africa_data)
plot(residuals(galaglm),parties)
plot(residuals(galaglm),pollib)
plot(residuals(galaglm),oligarchy)
qqnorm(residuals(galaglm))
qqnorm(residuals(galaglm), parties)
par(mfrow=c(2,2))
attach(africa_data)
plot(residuals(galaglm))
plot(residuals(galaglm),pollib)
plot(residuals(galaglm),oligarchy)
par(mfrow=c(2,2))
attach(africa_data)
plot(residuals(galaglm),parties)
plot(residuals(galaglm),pollib)
plot(residuals(galaglm),oligarchy)
par(mfrow=c(2,2))
attach(africa_data)
plot(fitted(galaglm),residuals(galaglm))
plot(residuals(galaglm),parties)
plot(residuals(galaglm),pollib)
plot(residuals(galaglm),oligarchy)
#Analysisof variance
galaglm_full=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size+numelec +numregim,family=poisson,data=africa_data)
summary(galaglm_full)
plot(residuals(galaglm_full),parties)
plot(residuals(galaglm_full),parties)
print(residuals(galaglm))
africa_data
par(mfrow=c(1,2))
plot(residuals(galaglm_full),parties)
plot(i:length(africa_data['parties']),cooks.distance(humberlm))
par(mfrow=c(1,2))
plot(residuals(galaglm_full),parties)
plot(1:length(africa_data['parties']),cooks.distance(galaglm))
par(mfrow=c(1,2))
plot(residuals(galaglm_full),parties)
#plot(1:length(africa_data['parties']),cooks.distance(galaglm))
print(residuals(galaglm))
length(residuals(galaglm))
par(mfrow=c(1,2))
plot(residuals(galaglm_full),parties)
plot(1:36,cooks.distance(galaglm))
print(residuals(galaglm))
plot(log(fitted(galaglm)),residuals(galaglm))
par(mfrow=c(1,3))
plot(residuals(galaglm_full),parties)
plot(log(fitted(galaglm)),residuals(galaglm))
plot(log(fitted(galaglm)),residuals(galaglm,type="response"))
#plot(1:36,cooks.distance(galaglm))
print(residuals(galaglm))
x=matrix(c(3,15,8,6),2,2)
fisher.test(x)
x
#transform distrubution, see if it looks same afterwards
```{r}
#transform distrubution, see if it looks same afterwards
```{r}
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(3,2))
hist(rpois(1000, lambda = 5))
hist(rpois(1000, lambda = 25))
hist(rpois(1000, lambda = 50))
hist(rpois(1000, lambda = 75))
hist(rpois(1000, lambda = 100))
hist(rpois(1000, lambda = 240))
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(3,2))
hist(rpois(1000, lambda = 2))
hist(rpois(1000, lambda = 25))
hist(rpois(1000, lambda = 50))
hist(rpois(1000, lambda = 75))
hist(rpois(1000, lambda = 100))
hist(rpois(1000, lambda = 240))
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(3,2))
hist(rpois(1000, lambda = 2))
hist(rpois(1000, lambda = 25))
hist(rpois(1000, lambda = 50))
hist(rpois(1000, lambda = 75))
hist(rpois(5, lambda = 100))
hist(rpois(1000, lambda = 240))
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(6,2))
hist(rpois(100, lambda = 1))
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(5,2))
hist(rpois(100, lambda = 1))
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(4,2))
hist(rpois(100, lambda = 1))
hist(rpois(100, lambda = 5))
hist(rpois(100, lambda = 10))
hist(rpois(100, lambda = 15))
hist(rpois(1000, lambda = 1))
hist(rpois(1000, lambda = 5))
hist(rpois(1000, lambda = 10))
hist(rpois(1000, lambda = 15))
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(2,2))
hist(rpois(100, lambda = 1))
hist(rpois(100, lambda = 5))
hist(rpois(100, lambda = 10))
hist(rpois(100, lambda = 15))
par(mfrow=c(2,2))
hist(rpois(1000, lambda = 1))
hist(rpois(1000, lambda = 5))
hist(rpois(1000, lambda = 10))
hist(rpois(1000, lambda = 15))
par(mfrow=c(2,2))
qnorm(hist(rpois(1000, lambda = 1)))
par(mfrow=c(2,2))
qnorm(rpois(1000, lambda = 1))
qnorm(rpois(1000, lambda = 15))
qnorm(rpois(100, lambda = 15))
qnorm(rpois(1000, lambda = 15))
par(mfrow=c(2,2))
qnorm(rpois(1000, lambda = 1))
qnorm(rpois(1000, lambda = 15))
qnorm(rpois(100, lambda = 15))
qnorm(rpois(1000, lambda = 15))
par(mfrow=c(2,2))
qqplot(rpois(1000, lambda = 1))
par(mfrow=c(2,2))
qqnorm(rpois(1000, lambda = 1))
qqnorm(rpois(1000, lambda = 15))
qqnorm(rpois(100, lambda = 15))
qqnorm(rpois(1000, lambda = 15))
par(mfrow=c(2,2))
qqnorm(rpois(500, lambda = 1))
qqnorm(rpois(500, lambda = 15))
qqnorm(rpois(100, lambda = 15))
qqnorm(rpois(1000, lambda = 15))
galaglm=glm(miltcoup~oligarchy+pollib+parties,family=poisson,data=africa_data)
error2 = summary(galaglm)$r.squared
summary(galaglm)
print(error1)
#Analysisof variance
galaglm_full=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size+numelec +numregim,family=poisson,data=africa_data)
error1 = summary(galaglm_full)$r.squared
summary(galaglm_full)
print(error1)
print(error2)
galaglm=glm(miltcoup~oligarchy+pollib+parties,family=poisson,data=africa_data)
error2 = summary(galaglm)$r.squared
print(summary(galaglm).r.squared)
galaglm=glm(miltcoup~oligarchy+pollib+parties,family=poisson,data=africa_data)
error2 = summary(galaglm)$r.squared
print(summary(galaglm)$adj.r.squared)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties,family=poisson,data=africa_data)
error2 = summary(galaglm)$r.squared
print(error2)
summary(galaglm)
par(mfrow=c(2,2))
attach(africa_data)
plot(fitted(galaglm_full),residuals(galaglm_full))
plot(residuals(galaglm_full),parties)
plot(residuals(galaglm_full),pollib)
plot(residuals(galaglm_full),oligarchy)
par(mfrow=c(1,3))
plot(residuals(galaglm_full),parties)
plot(log(fitted(galaglm_full)),residuals(galaglm_full))
plot(log(fitted(galaglm_full)),residuals(galaglm_full,type="response"))
print(residuals(galaglm_full))
par(mfrow=c(1,3))
plot(residuals(galaglm_full),parties)
plot(log(fitted(galaglm_full)),residuals(galaglm_full))
plot(log(fitted(galaglm_full)),residuals(galaglm_full,type="response"))
print(residuals(galaglm_full))
par(mfrow=c(1,3))
plot(residuals(galaglm_full),parties)
plot(log(fitted(galaglm)),residuals(galaglm))
plot(log(fitted(galaglm)),residuals(galaglm,type="response"))
#plot(1:36,cooks.distance(galaglm))
print(residuals(galaglm))
#Analysisof variance
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size +numregim,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn,family=poisson,data=africa_data)
summary(galaglm)
#Analysisof variance
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size +numregim,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties+pctvote,family=poisson,data=africa_data)
summary(galaglm)
galaglm=glm(miltcoup~oligarchy+pollib+parties,family=poisson,data=africa_data)
summary(galaglm)
africa_data
par(mfrow=c(2,2))
attach(africa_data)
plot(fitted(galaglm),residuals(galaglm))
plot(residuals(galaglm),parties)
plot(residuals(galaglm),pollib)
plot(residuals(galaglm),oligarchy)
par(mfrow=c(1,3))
plot(residuals(galaglm_full),parties)
plot(log(fitted(galaglm)),residuals(galaglm))
plot(log(fitted(galaglm)),residuals(galaglm,type="response"))
#plot(1:36,cooks.distance(galaglm))
print(residuals(galaglm))
par(mfrow=c(1,3))
plot(residuals(galaglm_full),parties)
plot(log(fitted(galaglm_full)),residuals(galaglm_full))
plot(log(fitted(galaglm_full)),residuals(galaglm_full,type="response"))
print(residuals(galaglm_full))
plot(pctvote, parties ,data=africa_data)
plot(pctvote, parties)
pairs(pctvote, parties)
pairs(africa_data[['pctvote', 'parties']])
pairs(africa_data['pctvote', 'parties'])
pairs(pctvote~parties)
pairs(pctvote~parties)
fruitflies=read.table('fruitflies.txt', header=TRUE)
fruitflies$loglongevity <- log(fruitflies$longevity)
fruitflies=read.table('fruitflies.txt', header=TRUE)
fruitflies$loglongevity <- log(fruitflies$longevity)
plot(loglongevity~thorax, pch=as.character(activity), col=as.numeric(activity), data=fruitflies)
abline(lm(loglongevity~thorax, data=fruitflies), col="blue")
# per activity:
boxplot(fruitflies$loglongevity~fruitflies$activity)
# thorax per activity (is there a significant difference between them?)
boxplot(fruitflies$thorax~fruitflies$activity)
flieslm = lm(loglongevity~activity, data=fruitflies)
anova(flieslm)
fruitflies
confint(flieslm)
summary(flieslm)
summary(anova(flieslm))
summary(flieslm)
fruitflies
confint(flieslm)
flieslm2 = lm(loglongevity~thorax+activity, data=fruitflies)
anova(flieslm2)
summary(flieslm2)
mean(fruitflies$thorax)
###    loglongevity_isolated= 1.21893 + 2.97899*0.8245333 + 0.40998 = 4.085186
1.21893 + 2.97899*mean(fruitflies$thorax) + 0.40998
###    loglongevity_low     = 1.21893 + 2.97899*0.8245333 + 0.28570 = 3.960906
1.21893 + 2.97899*mean(fruitflies$thorax) + 0.28570
###    loglongevity_high    = 1.21893 + 2.97899*0.8245333 - 0.69568 = 2.979526
1.21893 + 2.97899*mean(fruitflies$thorax) - 0.69568
min(fruitflies$thorax)
###    loglongevity_isolated= 1.21893 + 2.97899*0.64 + 0.40998 = 3.535464
1.21893 + 2.97899*min(fruitflies$thorax) + 0.40998
###    loglongevity_low     = 1.21893 + 2.97899*0.64 + 0.28570 = 3.411184
1.21893 + 2.97899*min(fruitflies$thorax) + 0.28570
###    loglongevity_high    = 1.21893 + 2.97899*0.64 - 0.69568 = 2.429804
1.21893 + 2.97899*min(fruitflies$thorax) - 0.69568
plot(loglongevity~thorax, pch=unclass(activity), col=as.numeric(activity), data=fruitflies)
for (i in 1:3) abline(lm(loglongevity~thorax, data=fruitflies[as.numeric(fruitflies$activity)==i,]), col=i)
legend("bottomright", legend=levels(fruitflies$activity), col=c(1,2,3), lty=1, cex=0.5)
qqnorm(residuals(flieslm2))
plot(fitted(flieslm2),residuals(flieslm2))
par(mfrow=c(1,2))
qqnorm(residuals(flieslm2))
plot(fitted(flieslm2),residuals(flieslm2))
flieslm3 = lm(longevity~thorax+activity, data=fruitflies)
qqnorm(residuals(flieslm3))
plot(fitted(flieslm3),residuals(flieslm3))
par(mfrow=c(1,2))
flieslm3 = lm(longevity~thorax+activity, data=fruitflies)
qqnorm(residuals(flieslm3))
plot(fitted(flieslm3),residuals(flieslm3))
africa_data=read.table("africa.txt", header=TRUE)
par(mfrow=c(3,2))
hist(rpois(1000, lambda = 2))
hist(rpois(1000, lambda = 25))
hist(rpois(1000, lambda = 50))
hist(rpois(1000, lambda = 75))
hist(rpois(1000, lambda = 100))
hist(rpois(1000, lambda = 240))
par(mfrow=c(2,2))
qqnorm(rpois(500, lambda = 1))
qqnorm(rpois(500, lambda = 15))
qqnorm(rpois(100, lambda = 15))
qqnorm(rpois(1000, lambda = 15))
#Analysisof variance
galaglm_full=glm(miltcoup~oligarchy+pollib+parties+pctvote+popn+size+numelec +numregim,family=poisson,data=africa_data)
error1 = summary(galaglm_full)$r.squared
summary(galaglm_full)
par(mfrow=c(1,3))
plot(residuals(galaglm_full),parties)
plot(log(fitted(galaglm_full)),residuals(galaglm_full))
plot(log(fitted(galaglm_full)),residuals(galaglm_full,type="response"))
print(residuals(galaglm_full))
pairs(pctvote~parties)
# per activity:
boxplot(fruitflies$loglongevity~fruitflies$activity)
# thorax per activity (is there a significant difference between them?)
boxplot(fruitflies$thorax~fruitflies$activity)
flieslm = lm(loglongevity~activity, data=fruitflies)
anova(flieslm)
confint(flieslm)
flieslm2 = lm(loglongevity~thorax+activity, data=fruitflies)
anova(flieslm2)
drop1(flieslm2,test="F")
summary(flieslm2)
par(mfrow=c(1,2))
qqnorm(residuals(flieslm2))
plot(fitted(flieslm2),residuals(flieslm2))
par(mfrow=c(1,2))
flieslm3 = lm(longevity~thorax+activity, data=fruitflies)
qqnorm(residuals(flieslm3))
plot(fitted(flieslm3),residuals(flieslm3))
psi=read.table('psi.txt', header=TRUE)
psi$psi=factor(psi$psi)
psi$passed=factor(psi$passed)
psilm = glm(passed~psi+gpa, data=psi, family=binomial)
psi$psi=factor(psi$psi)
psi$passed=factor(psi$passed)
psilm = glm(passed~psi+gpa, data=psi, family=binomial)
drop1(psilm,test="Chisq")
summary(psilm)
# Student with psi with a gpa is 3
1/(1+exp(-(-11.602 + 2.338*1 + 3.063*3)))
# Student without psi with a gpa is 3
1/(1+exp(-(-11.602 + 2.338*0 + 3.063*3)))
exp(2.338)
exp(2.338)
x=matrix(c(3,15,8,6),2,2)
fisher.test(x)
x=matrix(c(3,15,8,6),2,2)
fisher.test(x)
x=matrix(c(3,15,8,6),2,2)fisher.test(x)
x=matrix(c(3,15,8,6),2,2)
fisher.test(x)

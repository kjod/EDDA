lower_bound = date - 4
upper_bound = date + 5
df <- data.frame(airlines, before, after)
for(i in seq(from=1, to=length(airlines), by=1)){
df$before[i] = sum(data$Fatalities[data$Date >= lower_bound & data$Date <= date &
data$Operator == df$airlines[i]])
df$after[i] = sum(data$Fatalities[data$Date <= upper_bound & data$Date > date &
data$Operator == df$airlines[i]])
#append(x, values, after=length(x))
}
#statements
#return(something)
return(df)
}
setup_data <- function(date, range, data) {
}
### Analysis of data
setup_data <- function(date, range, data) {
airlines = unique(data$Operator)
before = rep(0, length(airlines))
after = rep(0, length(airlines))
lower_bound = date - 4
upper_bound = date + 5
df <- data.frame(airlines, before, after)
for(i in seq(from=1, to=length(airlines), by=1)){
df$before[i] = sum(data$Fatalities[data$Date >= lower_bound & data$Date <= date &
data$Operator == df$airlines[i]])
df$after[i] = sum(data$Fatalities[data$Date <= upper_bound & data$Date > date &
data$Operator == df$airlines[i]])
#append(x, values, after=length(x))
}
#statements
#return(something)
return(df)
}
setup_data(date, range, data)
airlines_data = read.csv("data/airline_data.csv", header=TRUE)
airlines_selection_data = airlines_data[airlines_data$Classification == "Non Military"]
names(airlines_data)
airlines_selection_data = airlines_data[airlines_data$Classification == "Non Military"]
airlines_data$Classification
airlines_selection_data = airlines_data[airlines_data$Classification == "Non Military",]
temp = as.Date(airlines_selection_data$Date,'%m/%d/%Y')
airlines_selection_data['Date'] = format(temp,'%Y')
names(airline_selection_data)
names(airline_selection_data)
airlines_data = read.csv("data/airline_data.csv", header=TRUE)
airlines_selection_data = airlines_data[airlines_data$Classification == "Non Military",]
temp = as.Date(airlines_selection_data$Date,'%m/%d/%Y')
airlines_selection_data['Date'] = format(temp,'%Y')
names(airline_selection_data)
names(airlines_selection_data)
aggregate_data = setup_data(1965, 5, airlines_selection_data)
hist(airlines_selection_data$Fatalities)
airlines_data = read.csv("data/airline_data.csv", header=TRUE)
hist(airlines_data$Fatalities)
par(mfrow=c(1,2))
hist(airlines_data$Fatalities)
qqnorm(airlines_data$Fatalities)
airlines_data = read.csv("data/airline_data.csv", header=TRUE)
par(mfrow=c(1,2))
hist(airlines_data$Fatalities)
qqnorm(airlines_data$Fatalities)
par(mfrow=c(1,2))
hist(airlines_data$Fatalities)
qqnorm(airlines_data$Fatalities)
par(mfrow=c(1,2))
hist(airlines_data$Fatalities)
qqnorm(airlines_data$Fatalities)
aggregate_data = setup_data(1965, 5, airlines_selection_data)
setup_data <- function(date, range, data) {
airlines = unique(data$Operator[data$Date == date])#remove filter to include airlines that didn't crash
before = rep(0, length(airlines))
after = rep(0, length(airlines))
lower_bound = date - range - 1
upper_bound = date + range
df <- data.frame(airlines, before, after)
for(i in seq(from=1, to=length(airlines), by=1)){
df$before[i] = sum(data$Fatalities[data$Date >= lower_bound & data$Date <= date &
data$Operator == df$airlines[i]])
df$after[i] = sum(data$Fatalities[data$Date <= upper_bound & data$Date > date &
data$Operator == df$airlines[i]])
}
return(df)
}
aggregate_data = setup_data(1965, 5, airlines_selection_data)
airlines_data = read.csv("data/airline_data.csv", header=TRUE)
par(mfrow=c(1,2))
hist(airlines_data$Fatalities)
qqnorm(airlines_data$Fatalities)
airlines_selection_data = airlines_data[airlines_data$Classification == "Non Military",]
temp = as.Date(airlines_selection_data$Date,'%m/%d/%Y')
airlines_selection_data['Date'] = format(temp,'%Y')
airlines_selection_data = airlines_data[airlines_data$Classification == "Non Military",]
temp = as.Date(airlines_selection_data$Date,'%m/%d/%Y')
airlines_selection_data['Date'] = format(temp,'%Y')
setup_data <- function(date, range, data) {
airlines = unique(data$Operator[data$Date == date])#remove filter to include airlines that didn't crash
before = rep(0, length(airlines))
after = rep(0, length(airlines))
lower_bound = date - range - 1
upper_bound = date + range
df <- data.frame(airlines, before, after)
for(i in seq(from=1, to=length(airlines), by=1)){
df$before[i] = sum(data$Fatalities[data$Date >= lower_bound & data$Date <= date &
data$Operator == df$airlines[i]])
df$after[i] = sum(data$Fatalities[data$Date <= upper_bound & data$Date > date &
data$Operator == df$airlines[i]])
}
return(df)
}
aggregate_data = setup_data(1965, 5, airlines_selection_data)
permutation_test(aggregate_data, 'Before', 'After')
setup_data <- function(date, range, data) {
airlines = unique(data$Operator[data$Date == date])#remove filter to include airlines that didn't crash
before = rep(0, length(airlines))
after = rep(0, length(airlines))
lower_bound = date - range - 1
upper_bound = date + range
df <- data.frame(airlines, before, after)
for(i in seq(from=1, to=length(airlines), by=1)){
df$before[i] = sum(data$Fatalities[data$Date >= lower_bound & data$Date <= date &
data$Operator == df$airlines[i]])
df$after[i] = sum(data$Fatalities[data$Date <= upper_bound & data$Date > date &
data$Operator == df$airlines[i]])
}
return(df)
}
permutation_test = function(mystat, col1, col2){
B=1000
tstar=numeric(B)
for (i in 1:B){
temp=t(apply(cbind(col1,col2),1,sample))
tstar[i]=mystat(temp[,1],temp[,2])
}
myt=mystat(col1,col2)
print(myt)
pl=sum(tstar<myt)/B
pr=sum(tstar>myt)/B
p=2*min(pl,pr)
print(p)
}
permutation_test(aggregate_data, 'Before', 'After')
aggregate_data = setup_data(1965, 5, airlines_selection_data)
permutation_test(aggregate_data, 'Before', 'After')
aggregate_data = setup_data(1965, 5, airlines_selection_data)
permutation_test(aggregate_data, 'Before', 'After')
permutation_test(aggregate_data, 'Before', 'After')
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$Before, aggregate_data$After)
print(length(aggrgate_data$Before))
print(length(aggregate_data$Before))
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$Before, aggregate_data$After)
print(length(aggregate_data$before))
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
aggregate_data = setup_data(1975, 5, airlines_selection_data)
print(length(aggregate_data$before))
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
aggregate_data = setup_data(1965, 5, airlines_selection_data)
print(length(aggregate_data$before))
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
aggregate_data = setup_data(1985, 5, airlines_selection_data)
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
aggregate_data = setup_data(2004, 5, airlines_selection_data)
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
airline=read.csv("data/airline-safety.csv", header=TRUE)
attach(airline)
head(airline)
par(mfrow=c(1,3))
boxplot(airline$incidents_85_99, airline$incidents_00_14)
boxplot(airline$fatal_accidents_85_99, airline$fatal_accidents_00_14)
boxplot(airline$fatalities_85_99, airline$fatalities_00_14)
par(mfrow=c(1,3))
boxplot(airline['incidents_85_99'], airline['incidents_00_14'], title="Indicents")
boxplot(airline$fatal_accidents_85_99, airline$fatal_accidents_00_14)
boxplot(airline$fatalities_85_99, airline$fatalities_00_14)
par(mfrow=c(1,3))
boxplot(airline$incidents_85_99, airline$incidents_00_14, names=c(“1985-1999“,“2000-2014“))
par(mfrow=c(1,3))
boxplot(airline$incidents_85_99, airline$incidents_00_14, names=c("1985-1999","2000-2014"))
boxplot(airline$fatal_accidents_85_99, airline$fatal_accidents_00_14)
boxplot(airline$fatalities_85_99, airline$fatalities_00_14)
par(mfrow=c(1,3))
boxplot(airline$incidents_85_99, airline$incidents_00_14, names=c("1985-1999","2000-2014"))
boxplot(airline$fatal_accidents_85_99, airline$fatal_accidents_00_14, names=c("1985-1999","2000-2014"))
boxplot(airline$fatalities_85_99, airline$fatalities_00_14, names=c("1985-1999","2000-2014"))
par(mfrow=c(1,3))
boxplot(airline$incidents_85_99, airline$incidents_00_14, names=c("1985-1999","2000-2014"), ylab ="Incidents", xlab ="Years")
boxplot(airline$fatal_accidents_85_99, airline$fatal_accidents_00_14, names=c("1985-1999","2000-2014"), ylab ="Accidents", xlab ="Years")
boxplot(airline$fatalities_85_99, airline$fatalities_00_14, names=c("1985-1999","2000-2014"), ylab ="Fatalities", xlab ="Years")
airline=read.csv("data/airline-safety.csv", header=TRUE)
attach(airline)
print(names(airline))
aggregate_data = setup_data(1965, 5, airlines_selection_data)
aggregate_data = setup_data(2004, 5, airlines_data)
setup_data <- function(date, range, data) {
airlines = unique(data$Operator[data$Date == date])#remove filter to include airlines that didn't crash
before = rep(0, length(airlines))
after = rep(0, length(airlines))
lower_bound = date - range - 1
upper_bound = date + range
df <- data.frame(airlines, before, after)
for(i in seq(from=1, to=length(airlines), by=1)){
df$before[i] = sum(data$Fatalities[data$Date >= lower_bound & data$Date <= date &
data$Operator == df$airlines[i]])
df$after[i] = sum(data$Fatalities[data$Date <= upper_bound & data$Date > date &
data$Operator == df$airlines[i]])
}
return(df)
}
aggregate_data = setup_data(2004, 5, airlines_data)
airline=read.csv("data/airline-safety.csv", header=TRUE)
attach(airline)
print(names(airline))
par(mfrow=c(1,3))
boxplot(airline$incidents_85_99, airline$incidents_00_14, names=c("1985-1999","2000-2014"), ylab ="Incidents", xlab ="Years")
boxplot(airline$fatal_accidents_85_99, airline$fatal_accidents_00_14, names=c("1985-1999","2000-2014"), ylab ="Accidents", xlab ="Years")
boxplot(airline$fatalities_85_99, airline$fatalities_00_14, names=c("1985-1999","2000-2014"), ylab ="Fatalities", xlab ="Years")
par(mfrow=c(1,2))
qqnorm(incidents_85_99-incidents_00_14)
hist(incidents_85_99-incidents_00_14)
insad=incidents_85_99-incidents_00_14
par(mfrow=c(1,2))
qqnorm(insad[insad<15])
hist(insad[insad<15])
t.test(insad[insad<15])
### Permutation Tests - No Normal distribution
permutation_test = function(mystat, col1, col2){
B=1000
tstar=numeric(B)
for (i in 1:B){
temp=t(apply(cbind(col1,col2),1,sample))
tstar[i]=mystat(temp[,1],temp[,2])
}
myt=mystat(col1,col2)
print(myt)
pl=sum(tstar<myt)/B
pr=sum(tstar>myt)/B
p=2*min(pl,pr)
print(p)
}
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat, incidents_85_99, incidents_00_14)
par(mfrow=c(1,2))
qqnorm(fatal_accidents_85_99-fatal_accidents_00_14)
hist(fatal_accidents_85_99-fatal_accidents_00_14)
fatal=fatal_accidents_85_99-fatal_accidents_00_14
par(mfrow=c(1,2))
qqnorm(fatal[fatal<7])
hist(fatal[fatal<7])
permutation_test(mystat, fatal_accidents_85_99, fatal_accidents_00_14)
par(mfrow=c(1,2))
qqnorm(fatalities_85_99-fatalities_00_14)
hist(fatalities_85_99-fatalities_00_14)
t.test(fatalities_85_99, fatalities_00_14, paired=TRUE)
airlines_data = read.csv("data/airline_data.csv", header=TRUE)
#delete Summary column
airlines_data=airlines_data[ , !(names(airlines_data)=='Summary')]
#transform Location column into countries
library(stringr)
temp=str_split_fixed(airlines_data$Location, ", ", 2)
countries=temp[,2]
airlines_data$Location=countries
#delete Empty Locations
airlines_data = airlines_data[!airlines_data$Location=="",]
#delete Military data
airlines_data = airlines_data[airlines_data$Classification=="Non Military",]
#transform Date to Years
temp = as.Date(airlines_data$Date,'%m/%d/%Y')
airlines_data$Date = format(temp,'%Y')
par(mfrow=c(1,2))
hist(airlines_data$Fatalities)
qqnorm(airlines_data$Fatalities)
airlines_selection_data = airlines_data[airlines_data$Classification == "Non Military",]
temp = as.Date(airlines_selection_data$Date,'%m/%d/%Y')
airlines_selection_data['Date'] = format(temp,'%Y')
setup_data <- function(date, range, data) {
airlines = unique(data$Operator[data$Date == date])#remove filter to include airlines that didn't crash
before = rep(0, length(airlines))
after = rep(0, length(airlines))
lower_bound = date - range - 1
upper_bound = date + range
df <- data.frame(airlines, before, after)
for(i in seq(from=1, to=length(airlines), by=1)){
df$before[i] = sum(data$Fatalities[data$Date >= lower_bound & data$Date <= date &
data$Operator == df$airlines[i]])
df$after[i] = sum(data$Fatalities[data$Date <= upper_bound & data$Date > date &
data$Operator == df$airlines[i]])
}
return(df)
}
aggregate_data = setup_data(2004, 5, airlines_data)
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
par(mfrow=c(1,2))
hist(airlines_data$Fatalities)
qqnorm(airlines_data$Fatalities)
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
aggregate_data = setup_data(2004, 1, airlines_data)
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
aggregate_data = setup_data(1973, 1, airlines_data)
year = 1955
range = 15
print(range)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 10
print(range)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 5
print(range)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1955
range = 15
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 30
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 5
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1955
range = 15
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 30
print(paste("Testing:", year))
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 5
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1955
range = 15
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 30
print(paste("Testing:", year))
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 2004
range = 5
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1955
range = 15
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 10
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 2004
range = 5
print(year)
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
### Permutation Tests - No Normal distribution
permutation_test = function(mystat, col1, col2){
B=1000
tstar=numeric(B)
for (i in 1:B){
temp=t(apply(cbind(col1,col2),1,sample))
tstar[i]=mystat(temp[,1],temp[,2])
}
myt=mystat(col1,col2)
#print(myt)
pl=sum(tstar<myt)/B
pr=sum(tstar>myt)/B
p=2*min(pl,pr)
print(paste("Threshold: ", myt ,"P-value:", p))
#print(p)
}
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat, incidents_85_99, incidents_00_14)
year = 1955
range = 15
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1975
range = 10
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 2004
range = 5
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
print(permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after))
year = 1955
range = 15
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1975
range = 10
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 2004
range = 5
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 15
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
mystat=function(x,y) {mean(x-y)}
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1975
range = 10
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 2004
range = 5
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 10
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 5
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 10
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 5
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 2
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 10
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 5
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1955
range = 2
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
year = 1975
range = 15
print(paste("Testing on year:", year, " Using range:", range))
aggregate_data = setup_data(year, range, airlines_data)
permutation_test(mystat=function(x,y) {mean(x-y)}, aggregate_data$before, aggregate_data$after)
